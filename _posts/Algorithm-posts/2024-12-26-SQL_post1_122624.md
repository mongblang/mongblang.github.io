---
title: "[프로그래머스] 상품 별 오프라인 매출 구하기 - SQL"
date: 2024-12-26  
categories: [코딩테스트 연습, SQL코테]
tags: [SQL, GROUP BY]
layout: post
author: mongblang
---

# 📌&nbsp; **프로그래머스 SQL 고득점 Kit - JOIN 문제 2**
[문제 링크](https://school.programmers.co.kr/learn/courses/30/lessons/131533)  

# 📝&nbsp; **문제**
---
![problem](/assets/img/codingtest-post-img/PGSQL_join2-1.png)



## ✏️&nbsp; **입출력 예시**
---
![example](/assets/img/codingtest-post-img/PGSQL_join2-2.png)



&nbsp;  

&nbsp;   
   


## **내 풀이**  
---  

```sql
SELECT PRODUCT_CODE, SUM(PRICE * SALES_AMOUNT) AS SALES
FROM PRODUCT A JOIN OFFLINE_SALE B ON A.PRODUCT_ID = B.PRODUCT_ID
GROUP BY PRODUCT_CODE
ORDER BY SALES DESC, PRODUCT_CODE
```

#### **코드 해설**
1. product 테이블과 offline_sale 테이블을 상품코드를 기준으로 이너조인한다.
2. 상품코드별로 그룹화한 후 판매가 * 판매량의 합계를 계산해 Sales 컬럼으로 정의한다. 
3. Sales를 기준으로 내림차순 하고, Sales의 값이 같다면 상품코드를 기준으로 오름차순 정렬한다. 

&nbsp;   

