---
title: "[프로그래머스] 주문량이 많은 아이스크림들 조회하기 - SQL"
date: 2025-01-06  
categories: [코딩테스트 연습, SQL코테]
tags: [SQL, GROUP BY]
layout: post
author: mongblang
---

# 📌&nbsp; **프로그래머스 SQL 고득점 Kit - JOIN 문제 6**
[문제 링크](https://school.programmers.co.kr/learn/courses/30/lessons/133027)  

# 📝&nbsp; **문제**
---
![problem](/assets/img/codingtest-post-img/PGSQL_join6-1.png)


## ✏️&nbsp; **입출력 예시**
---
![example](/assets/img/codingtest-post-img/PGSQL_join6-2.png)
![example2](/assets/img/codingtest-post-img/PGSQL_join6-3.png)
![example3](/assets/img/codingtest-post-img/PGSQL_join6-4.png)



&nbsp;  

&nbsp;   
   


## **내 풀이**  
---  

```sql
SELECT A.FLAVOR 
FROM (SELECT FLAVOR, SUM(TOTAL_ORDER) AS TOTAL_ORDER 
      FROM FIRST_HALF
      GROUP BY FLAVOR) AS A
      INNER JOIN (SELECT FLAVOR, SUM(TOTAL_ORDER)AS TOTAL_ORDER
                 FROM JULY
                 GROUP BY FLAVOR) AS B
                 ON A.FLAVOR = B.FLAVOR
ORDER BY (A.TOTAL_ORDER + B.TOTAL_ORDER) DESC
LIMIT 3
```

#### **코드 해설**
1. 상반기 테이블과 7월 테이블의 맛별 총 주문량을 서브쿼리를 사용해 계산한다.
2. 두 테이블을 맛을 기준으로 조인한다. 같은 아이스크림에 대하여 서로 다른 두 공장에서 아이스크림 가게로 출하를 진행하는 경우가 있다고 했으니 SHIPMENT_ID로 조인하지 않도록 주의
3. 총 주문량의 합계를 기준으로 내림차순 정렬한 뒤 가장 값이 큰 3개의 맛만 조회한다. 

&nbsp;   

